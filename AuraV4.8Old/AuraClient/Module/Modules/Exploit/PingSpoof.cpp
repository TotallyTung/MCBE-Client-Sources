#include "PingSpoof.h"
PingSpoof::PingSpoof() : IModule(0x0, Category::EXPLOIT, "Attacks entities around you automatically") {
	registerIntSetting("Ping", &delay, delay, 0, 200);
	registerBoolSetting("Show Ping", &showPing, showPing);
}
PingSpoof::~PingSpoof() {
}
const char* PingSpoof::getRawModuleName() {
	return "PingSpoof";
}
const char* PingSpoof::getModuleName() {
	if (showPing) {
		name = std::string("PingSpoof ") + std::string(GRAY) + std::string(WHITE) + std::string(" [") + std::string(GRAY) + std::to_string((int)(delay)) + std::string(WHITE) + std::string("]");
	}
	return "";
}
void PingSpoof::onTick(C_GameMode* gm) {
	static auto lastTime = std::chrono::high_resolution_clock::now();
	auto currentTime = std::chrono::high_resolution_clock::now();
	if (std::chrono::duration_cast<std::chrono::milliseconds>(currentTime - lastTime).count() < delay) {
		skipTicks = true;
	}
	else {
		skipTicks = false;
		lastTime = std::chrono::high_resolution_clock::now();
	}
}
void PingSpoof::onDisable() {
	skipTicks = false;
}